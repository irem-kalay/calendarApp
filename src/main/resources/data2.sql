-- --- Temel Tanım Tabloları (Dimension Tables) ---

CREATE TABLE region (
    id           NUMBER(19) GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    countryname  VARCHAR2(100) NOT NULL,
    countrycode  VARCHAR2(10) NOT NULL,
    CONSTRAINT region_countrycode_uk UNIQUE (countrycode)
);

CREATE TABLE persontypes (
    id     NUMBER(19) GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name   VARCHAR2(50) NOT NULL,
    CONSTRAINT persontypes_name_uk UNIQUE (name)
);

CREATE TABLE holiday_types (
    id     NUMBER(19) GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name   VARCHAR2(50) NOT NULL,
    CONSTRAINT holiday_types_name_uk UNIQUE (name)
);



-- --- Aşama 1: Tatil Tanımları (Ana Liste - Kavramsal) ---
CREATE TABLE holiday_definitions (
    id       NUMBER(19) GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name     VARCHAR2(300) NOT NULL,
    type_id  NUMBER(19) NOT NULL,
    CONSTRAINT holiday_definitions_name_uk UNIQUE (name),
    CONSTRAINT fk_hd_type FOREIGN KEY (type_id) REFERENCES holiday_types (id)
);


-- --- Aşama 2: Tatil Periyotları (Yıllık Zamanlama - Yönetim) ---
CREATE TABLE holiday_periods (
    id             NUMBER(19) GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    definition_id  NUMBER(19) NOT NULL,
    start_date     DATE NOT NULL,
    end_date       DATE NOT NULL,
    CONSTRAINT fk_hp_definition FOREIGN KEY (definition_id) REFERENCES holiday_definitions (id)
);


-- --- Aşama 3: Tatil Günleri (API Performans Katmanı - Türetilmiş) ---
CREATE TABLE holidays (
    id              NUMBER(19) GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    calendar_date   DATE NOT NULL,
    period_id       NUMBER(19) NOT NULL,
    is_full_day      NUMBER(1) DEFAULT 1 NOT NULL,
    CONSTRAINT holidays_calendar_date_uk UNIQUE (calendar_date),
    CONSTRAINT fk_h_period FOREIGN KEY (period_id) REFERENCES holiday_periods (id)
);


ALTER TABLE holidays
DROP CONSTRAINT holidays_calendar_date_uk;

ALTER TABLE holiday_definitions
ADD is_fixed NUMBER(1) DEFAULT 0 NOT NULL;
---DEĞİŞMEYENLER 1, EDĞİŞENLER 0--------------

commit;
-- --- Kural Tablosu ---
CREATE TABLE junction (
    holiday_id       NUMBER(19) NOT NULL,
    region_id        NUMBER(19) NOT NULL,
    person_type_id   NUMBER(19) NOT NULL,
    CONSTRAINT junction_pk PRIMARY KEY (holiday_id, region_id, person_type_id),
    CONSTRAINT fk_j_holiday FOREIGN KEY (holiday_id) REFERENCES holidays (id),
    CONSTRAINT fk_j_region FOREIGN KEY (region_id) REFERENCES region (id),
    CONSTRAINT fk_j_persontype FOREIGN KEY (person_type_id) REFERENCES persontypes (id)
);


-- --- Çeviri Tablosu ---
CREATE TABLE translations (
    table_name         VARCHAR2(30) NOT NULL,
    record_id          NUMBER(19) NOT NULL,
    lang_code          VARCHAR2(10) NOT NULL,
    translation_text   VARCHAR2(500) NOT NULL,
    CONSTRAINT translations_pk PRIMARY KEY (table_name, record_id, lang_code),
    CONSTRAINT fk_t_lang_code FOREIGN KEY (lang_code) REFERENCES region (countrycode)
);


-- --- Açıklamalar (Comments) ---

COMMENT ON TABLE holiday_definitions IS '"Ramazan Bayramı" gibi tatil kavramları burada bir kez tanımlanır.';
COMMENT ON TABLE holiday_periods IS 'Bir tatilin belirli bir yıldaki zaman aralığı burada girilir. Veri girişi bu tabloya yapılır.';
COMMENT ON TABLE holidays IS 'API''nin hızlı sorgu yapması için, holiday_periods''ten türetilen, her bir tatil gününü tek satırda tutan tablo.';
COMMENT ON TABLE junction IS 'Bir tatil gününün, hangi bölge ve kişi tipi için geçerli olduğunu tanımlar.';
COMMENT ON COLUMN junction.is_full_day IS '1: Tam Gün Tatil, 2: Yarım Gün Tatil';



--notlar için holidays tablosuna kolon ekliyorum
ALTER TABLE holidays ADD (notes VARCHAR2(500));



drop table junction;
drop table holidays;
drop table holiday_periods;
drop table holiday_definitions;
drop table holiday_types;
drop table region;

---------------DENEME QUERY'ler------------------------
SELECT 
    h.calendar_date,
    h.is_full_day,
    hd.name AS holiday_name,
    h.notes,
    ht.name AS holiday_type
FROM 
    holidays h,
    holiday_periods hp,
    holiday_definitions hd,
    holiday_types ht
WHERE 
    h.period_id = hp.id
    AND hp.definition_id = hd.id
    AND hd.type_id = ht.id
ORDER BY 
    h.calendar_date ASC;

---bölge ve kişiye göre tatiller
SELECT 
    h.calendar_date,
    hd.name AS holiday_name,
    ht.name AS holiday_type,
    CASE 
        WHEN h.is_full_day = 1 THEN 'Tam Gün'
        WHEN h.is_full_day = 2 THEN 'Yarım Gün'
    END AS day_type,
    r.countryname,
    pt.name AS person_type
FROM 
    holidays h,
    holiday_periods hp,
    holiday_definitions hd,
    holiday_types ht,
    junction j,
    region r,
    persontypes pt
WHERE 
    h.period_id = hp.id
    AND hp.definition_id = hd.id
    AND hd.type_id = ht.id
    AND h.id = j.holiday_id
    AND j.region_id = r.id
    AND j.person_type_id = pt.id
    AND r.countrycode = 'TR'  -- Sadece Türkiye tatilleri için
ORDER BY 
    h.calendar_date ASC, 
    pt.name ASC;

--tatil periyotları
SELECT 
    hp.start_date,
    hp.end_date,
    hd.name AS holiday_name,
    ht.name AS holiday_type,
    (hp.end_date - hp.start_date + 1) AS total_days
FROM 
    holiday_periods hp,
    holiday_definitions hd,
    holiday_types ht
WHERE 
    hp.definition_id = hd.id
    AND hd.type_id = ht.id
ORDER BY 
    hp.start_date ASC;

---2025 yılı tatil takvimi
SELECT 
    TO_CHAR(h.calendar_date, 'DD-MM-YYYY Day', 'NLS_DATE_LANGUAGE=Turkish') AS tarih,
    hd.name AS tatil_adi,
    ht.name AS tatil_turu,
    CASE 
        WHEN h.is_full_day = 1 THEN 'Tam Gün Tatil'
        WHEN h.is_full_day = 2 THEN 'Yarım Gün Tatil (Arife)'
    END AS gun_tipi
FROM 
    holidays h,
    holiday_periods hp,
    holiday_definitions hd,
    holiday_types ht
WHERE 
    h.period_id = hp.id
    AND hp.definition_id = hd.id
    AND hd.type_id = ht.id
    AND EXTRACT(YEAR FROM h.calendar_date) = 2025
ORDER BY 
    h.calendar_date ASC;


-------------PUBLIC EKLEME--------------
-----------------insert işlemleri--------------------------------------------------------------
--region tablosuna ülkeyi ekliyorum
INSERT INTO region (id, countryname, countrycode) VALUES (1, 'Türkiye', 'TR');
INSERT INTO region (id, countryname, countrycode) VALUES (2, 'England', 'ENG');
commit;

---persontypes tablosuna ekleme
INSERT INTO persontypes (id, name) VALUES (1, 'Public');
INSERT INTO persontypes (id, name) VALUES (2, 'Beyaz Yaka');


----holiday_type ekliyorum 
INSERT INTO holiday_types (id, name) VALUES (1, 'Milli Bayram');
INSERT INTO holiday_types (id, name) VALUES (2, 'Dini Bayram');
INSERT INTO holiday_types (id, name) VALUES (3, 'İdari İzin');

INSERT INTO holiday_types (id, name) VALUES (4, 'Bank Holiday');
INSERT INTO holiday_types (id, name) VALUES (5, 'Religious Holiday');
commit;


---Tatil tanımları (holiday_definitions) ekliyorum
INSERT INTO holiday_definitions (id, name, type_id)
VALUES (10, 'Ramazan Bayramı', 2); --type id'si 2: dini bayram

INSERT INTO holiday_definitions (id, name, type_id)
VALUES (20, 'Kurban Bayramı', 2); --type id'si 2: dini bayram

INSERT INTO holiday_definitions (id, name, type_id)
VALUES (30, 'Yılbaşı', 3); --type id'si 3: idari izin

INSERT INTO holiday_definitions (id, name, type_id)
VALUES (40, 'Ulusal Egemenlik ve Çocuk Bayramı', 1); --type id'si 1: milli bayram

INSERT INTO holiday_definitions (id, name, type_id)
VALUES (50, 'İşçi Bayramı', 1); --type id'si 1: milli bayram

INSERT INTO holiday_definitions (id, name, type_id)
VALUES (60, 'Atatürk''ü Anma Gençlik ve Spor Bayramı', 1); --type id'si 1: milli bayram

INSERT INTO holiday_definitions (id, name, type_id)
VALUES (70, 'Demokrasi ve Milli Birlik Günü', 1); --type id'si 1: milli bayram

INSERT INTO holiday_definitions (id, name, type_id)
VALUES (80, 'Zafer Bayramı', 1); --type id'si 1: milli bayram

INSERT INTO holiday_definitions (id, name, type_id)
VALUES (90, 'Cumhuriyet Bayramı', 1); --type id'si 1: milli bayram

commit;

-- İngiltere tatil tanımlarını (holiday_definitions) ekle
INSERT INTO holiday_definitions (id, name, type_id)
VALUES (100, 'New Year''s Day', 4); -- Bank Holiday

INSERT INTO holiday_definitions (id, name, type_id)
VALUES (110, 'Good Friday', 5); -- Religious Holiday

INSERT INTO holiday_definitions (id, name, type_id)
VALUES (120, 'Easter Monday', 5); -- Religious Holiday

INSERT INTO holiday_definitions (id, name, type_id)
VALUES (130, 'Early May Bank Holiday', 4); -- Bank Holiday

INSERT INTO holiday_definitions (id, name, type_id)
VALUES (140, 'Spring Bank Holiday', 4); -- Bank Holiday

INSERT INTO holiday_definitions (id, name, type_id)
VALUES (150, 'Summer Bank Holiday', 4); -- Bank Holiday

INSERT INTO holiday_definitions (id, name, type_id)
VALUES (160, 'Christmas Day', 5); -- Religious Holiday

INSERT INTO holiday_definitions (id, name, type_id)
VALUES (170, 'Boxing Day', 4); -- Bank Holiday

commit;

----Tatil periyotlarını (holiday_periods) giriyorum
--Ramazan bayramı
INSERT INTO holiday_periods (id, definition_id, start_date, end_date)
VALUES (200, 10, TO_DATE('29-03-2025', 'DD-MM-YYYY'), TO_DATE('01-04-2025', 'DD-MM-YYYY')); -- 10: Ramazan Bayramı

--kurban bayramı
INSERT INTO holiday_periods (id, definition_id, start_date, end_date)
VALUES (201, 20, TO_DATE('05-06-2025', 'DD-MM-YYYY'), TO_DATE('09-06-2025', 'DD-MM-YYYY')); -- 20: Kurban Bayramı

--yılbaşı
INSERT INTO holiday_periods (id, definition_id, start_date, end_date)
VALUES (202, 30, TO_DATE('01-01-2025', 'DD-MM-YYYY'), TO_DATE('01-01-2025', 'DD-MM-YYYY')); -- 30: Yılbaşı

--23 nisan ulusal egemenlik ve çocuk bayramı
INSERT INTO holiday_periods (id, definition_id, start_date, end_date)
VALUES (203, 40, TO_DATE('23-04-2025', 'DD-MM-YYYY'), TO_DATE('23-04-2025', 'DD-MM-YYYY')); -- 40: 23 nisan

--1 Mayıs İşçi Bayramı
INSERT INTO holiday_periods (id, definition_id, start_date, end_date)
VALUES (204, 50, TO_DATE('01-05-2025', 'DD-MM-YYYY'), TO_DATE('01-05-2025', 'DD-MM-YYYY')); -- 50: 1 Mayıs

--19 mayıs
INSERT INTO holiday_periods (id, definition_id, start_date, end_date)
VALUES (205, 60, TO_DATE('19-05-2025', 'DD-MM-YYYY'), TO_DATE('19-05-2025', 'DD-MM-YYYY')); -- 60: 19 Mayıs

--15 temmuz
INSERT INTO holiday_periods (id, definition_id, start_date, end_date)
VALUES (206, 70, TO_DATE('15-07-2025', 'DD-MM-YYYY'), TO_DATE('15-07-2025', 'DD-MM-YYYY')); -- 70: 15 Temmuz

--30 ağustos
INSERT INTO holiday_periods (id, definition_id, start_date, end_date)
VALUES (207, 80, TO_DATE('30-08-2025', 'DD-MM-YYYY'), TO_DATE('30-08-2025', 'DD-MM-YYYY')); -- 80: 30 Ağustos

--29 ekim (28 Ekim arife dahil)
INSERT INTO holiday_periods (id, definition_id, start_date, end_date)
VALUES (208, 90, TO_DATE('28-10-2025', 'DD-MM-YYYY'), TO_DATE('29-10-2025', 'DD-MM-YYYY')); -- 90: 29 Ekim

-- İngiltere tatil periyotlarını (holiday_periods) ekle
-- New Year's Day
INSERT INTO holiday_periods (id, definition_id, start_date, end_date)
VALUES (299, 100, TO_DATE('01-01-2025', 'DD-MM-YYYY'), TO_DATE('01-01-2025', 'DD-MM-YYYY'));

-- Good Friday
INSERT INTO holiday_periods (id, definition_id, start_date, end_date)
VALUES (301, 110, TO_DATE('18-04-2025', 'DD-MM-YYYY'), TO_DATE('18-04-2025', 'DD-MM-YYYY'));

-- Easter Monday
INSERT INTO holiday_periods (id, definition_id, start_date, end_date)
VALUES (302, 120, TO_DATE('21-04-2025', 'DD-MM-YYYY'), TO_DATE('21-04-2025', 'DD-MM-YYYY'));

-- Early May Bank Holiday
INSERT INTO holiday_periods (id, definition_id, start_date, end_date)
VALUES (303, 130, TO_DATE('05-05-2025', 'DD-MM-YYYY'), TO_DATE('05-05-2025', 'DD-MM-YYYY'));

-- Spring Bank Holiday
INSERT INTO holiday_periods (id, definition_id, start_date, end_date)
VALUES (304, 140, TO_DATE('26-05-2025', 'DD-MM-YYYY'), TO_DATE('26-05-2025', 'DD-MM-YYYY'));

-- Summer Bank Holiday
INSERT INTO holiday_periods (id, definition_id, start_date, end_date)
VALUES (305, 150, TO_DATE('25-08-2025', 'DD-MM-YYYY'), TO_DATE('25-08-2025', 'DD-MM-YYYY'));

-- Christmas Day
INSERT INTO holiday_periods (id, definition_id, start_date, end_date)
VALUES (306, 160, TO_DATE('25-12-2025', 'DD-MM-YYYY'), TO_DATE('25-12-2025', 'DD-MM-YYYY'));

-- Boxing Day
INSERT INTO holiday_periods (id, definition_id, start_date, end_date)
VALUES (307, 170, TO_DATE('26-12-2025', 'DD-MM-YYYY'), TO_DATE('26-12-2025', 'DD-MM-YYYY'));

commit;

-- holidays tablosuna İngiltere tatil günlerini ekle (hepsi tam gün tatil)
-- New Year's Day
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (601, TO_DATE('01-01-2025', 'DD-MM-YYYY'), 299, 1, 'New Year''s Day');


-- Good Friday
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (602, TO_DATE('18-04-2025', 'DD-MM-YYYY'), 301, 1, 'Good Friday');

-- Easter Monday
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (603, TO_DATE('21-04-2025', 'DD-MM-YYYY'), 302, 1, 'Easter Monday');

-- Early May Bank Holiday
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (604, TO_DATE('05-05-2025', 'DD-MM-YYYY'), 303, 1, 'Early May Bank Holiday');

-- Spring Bank Holiday
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (605, TO_DATE('26-05-2025', 'DD-MM-YYYY'), 304, 1, 'Spring Bank Holiday');

-- Summer Bank Holiday
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (606, TO_DATE('25-08-2025', 'DD-MM-YYYY'), 305, 1, 'Summer Bank Holiday');

-- Christmas Day
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (607, TO_DATE('25-12-2025', 'DD-MM-YYYY'), 306, 1, 'Christmas Day');

-- Boxing Day
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (608, TO_DATE('26-12-2025', 'DD-MM-YYYY'), 307, 1, 'Boxing Day');

commit;
-- --- Adım 4: holidays tablosuna günleri ekliyorum ---
--notlar için holidays tablosuna kolon ekliyorum
ALTER TABLE holidays ADD (notes VARCHAR2(500));

---Ramazan Bayramı Arife
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (501, TO_DATE('29-03-2025', 'DD-MM-YYYY'), 200, 2, 'Ramazan Bayramı Arife - Yarım gün tatil');

-- Ramazan Bayramı 1. Günü
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (502, TO_DATE('30-03-2025', 'DD-MM-YYYY'), 200, 1, 'Ramazan Bayramı 1. Gün');

-- Ramazan Bayramı 2. Günü
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (503, TO_DATE('31-03-2025', 'DD-MM-YYYY'), 200, 1, 'Ramazan Bayramı 2. Gün');

-- Ramazan Bayramı 3. Günü
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (504, TO_DATE('01-04-2025', 'DD-MM-YYYY'), 200, 1, 'Ramazan Bayramı 3. Gün');

---Kurban Bayramı arife
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (505, TO_DATE('05-06-2025', 'DD-MM-YYYY'), 201, 2, 'Kurban Bayramı Arife - Yarım gün tatil');

-- Kurban Bayramı 1. Günü
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (506, TO_DATE('06-06-2025', 'DD-MM-YYYY'), 201, 1, '1. Gün');

-- Kurban Bayramı 2. Günü
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (507, TO_DATE('07-06-2025', 'DD-MM-YYYY'), 201, 1, '2. Gün');

-- Kurban Bayramı 3. Günü
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (508, TO_DATE('08-06-2025', 'DD-MM-YYYY'), 201, 1, '3. Gün');

-- Kurban Bayramı 4. Günü
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (509, TO_DATE('09-06-2025', 'DD-MM-YYYY'), 201, 1, '4. Gün');

-- Yılbaşı
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (510, TO_DATE('01-01-2025', 'DD-MM-YYYY'), 202, 1, 'Yılbaşı');

-- 23 Nisan
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (511, TO_DATE('23-04-2025', 'DD-MM-YYYY'), 203, 1, 'Ulusal Egemenlik ve Çocuk Bayramı');

-- 1 Mayıs
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (512, TO_DATE('01-05-2025', 'DD-MM-YYYY'), 204, 1, 'Emek ve Dayanışma Günü');

-- 19 Mayıs
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (513, TO_DATE('19-05-2025', 'DD-MM-YYYY'), 205, 1, 'Atatürk''ü Anma, Gençlik ve Spor Bayramı');

-- 15 Temmuz
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (514, TO_DATE('15-07-2025', 'DD-MM-YYYY'), 206, 1, 'Demokrasi ve Milli Birlik Günü');

-- 30 Ağustos
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (515, TO_DATE('30-08-2025', 'DD-MM-YYYY'), 207, 1, 'Zafer Bayramı');

-- 29 Ekim Arife
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (516, TO_DATE('28-10-2025', 'DD-MM-YYYY'), 208, 2, 'Cumhuriyet Bayramı Arifesi - Yarım gün');

-- 29 Ekim
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (517, TO_DATE('29-10-2025', 'DD-MM-YYYY'), 208, 1, 'Cumhuriyet Bayramı');

commit;

-- --- Adım 5: Junction tablosunda PUBLIC için kuralları ata ---
-- Region ID: 1 (Türkiye)
-- Person Type ID: 3 (Public)

-- Ramazan Bayramı günleri için kurallar
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (501, 1, 1); -- Arife
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (502, 1, 1); -- 1. Gün
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (503, 1, 1); -- 2. Gün
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (504, 1, 1); -- 3. Gün

-- Kurban Bayramı günleri için kurallar
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (505, 1, 1); -- Arife
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (506, 1, 1); -- 1. Gün
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (507, 1, 1); -- 2. Gün
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (508, 1, 1); -- 3. Gün
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (509, 1, 1); -- 4. Gün

-- Milli ve Resmi Tatiller için kurallar
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (510, 1, 1); -- Yılbaşı
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (511, 1, 1); -- 23 Nisan
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (512, 1, 1); -- 1 Mayıs
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (513, 1, 1); -- 19 Mayıs
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (514, 1, 1); -- 15 Temmuz
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (515, 1, 1); -- 30 Ağustos
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (516, 1, 1); -- 29 Ekim Arife
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (517, 1, 1); -- 29 Ekim

commit;

INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (601, 2, 1); -- New Year's Day
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (602, 2, 1); -- Good Friday
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (603, 2, 1); -- Easter Monday
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (604, 2, 1); -- Early May
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (605, 2, 1); -- Spring Bank
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (606, 2, 1); -- Summer Bank
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (607, 2, 1); -- Christmas
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (608, 2, 1); -- Boxing Day

commit;


-- Public için 2025 tatil takvimini kontrol et
SELECT 
    TO_CHAR(h.calendar_date, 'DD-MM-YYYY Day', 'NLS_DATE_LANGUAGE=Turkish') AS tarih,
    hd.name AS tatil_adi,
    ht.name AS tatil_turu,
    CASE 
        WHEN h.is_full_day = 1 THEN 'Tam Gün Tatil'
        WHEN h.is_full_day = 2 THEN 'Yarım Gün Tatil'
    END AS gun_tipi,
    h.notes AS aciklama
FROM 
    holidays h,
    holiday_periods hp,
    holiday_definitions hd,
    holiday_types ht,
    junction j,
    persontypes pt
WHERE 
    h.period_id = hp.id
    AND hp.definition_id = hd.id
    AND hd.type_id = ht.id
    AND h.id = j.holiday_id
    AND j.person_type_id = pt.id
    AND j.region_id = 1  -- Türkiye
    AND pt.name = 'Public' --public herkes için kontrol ediyor
    AND EXTRACT(YEAR FROM h.calendar_date) = 2025
ORDER BY 
    h.calendar_date ASC;

--- easter holiday ekliyorum öğrenciler için 2 haftaymış
-- İngiltere için öğrenci person type ekle (id: 5 olarak, 3 Türkiye'de Public için kullanılmış)
INSERT INTO persontypes (id, name) VALUES (3, 'Students');
COMMIT;

-- Öğrenci tatil tipini ekle
INSERT INTO holiday_types (id, name) VALUES (6, 'School Holiday');
COMMIT;

-- Easter Holiday tanımını ekle
INSERT INTO holiday_definitions (id, name, type_id)
VALUES (180, 'Easter School Holiday', 6);
COMMIT;

-- Easter Holiday periyodunu ekle (Good Friday ve Easter Monday hariç günler)
INSERT INTO holiday_periods (id, definition_id, start_date, end_date)
VALUES (308, 180, TO_DATE('07-04-2025', 'DD-MM-YYYY'), TO_DATE('17-04-2025', 'DD-MM-YYYY'));
COMMIT;

-- holidays tablosuna öğrenci tatil günlerini ekle (18 ve 21 Nisan HARİÇ)
-- 7 Nisan Pazartesi
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (620, TO_DATE('07-04-2025', 'DD-MM-YYYY'), 308, 1, 'Easter School Holiday');

-- 8 Nisan Salı
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (621, TO_DATE('08-04-2025', 'DD-MM-YYYY'), 308, 1, 'Easter School Holiday');

-- 9 Nisan Çarşamba
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (622, TO_DATE('09-04-2025', 'DD-MM-YYYY'), 308, 1, 'Easter School Holiday');

-- 10 Nisan Perşembe
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (623, TO_DATE('10-04-2025', 'DD-MM-YYYY'), 308, 1, 'Easter School Holiday');

-- 11 Nisan Cuma
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (624, TO_DATE('11-04-2025', 'DD-MM-YYYY'), 308, 1, 'Easter School Holiday');

-- 14 Nisan Pazartesi
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (625, TO_DATE('14-04-2025', 'DD-MM-YYYY'), 308, 1, 'Easter School Holiday');

-- 15 Nisan Salı
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (626, TO_DATE('15-04-2025', 'DD-MM-YYYY'), 308, 1, 'Easter School Holiday');

-- 16 Nisan Çarşamba
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (627, TO_DATE('16-04-2025', 'DD-MM-YYYY'), 308, 1, 'Easter School Holiday');

-- 17 Nisan Perşembe
INSERT INTO holidays (id, calendar_date, period_id, is_full_day, notes)
VALUES (628, TO_DATE('17-04-2025', 'DD-MM-YYYY'), 308, 1, 'Easter School Holiday');

COMMIT;

-- Junction tablosunda sadece UK Students (person_type_id: 5) için ilişkilendir
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (620, 2, 3); -- 7 Nisan
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (621, 2, 3); -- 8 Nisan
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (622, 2, 3); -- 9 Nisan
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (623, 2, 3); -- 10 Nisan
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (624, 2, 3); -- 11 Nisan
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (625, 2, 3); -- 14 Nisan
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (626, 2, 3); -- 15 Nisan
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (627, 2, 3); -- 16 Nisan
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (628, 2, 3); -- 17 Nisan

-- Good Friday (18 Nisan) ve Easter Monday (21 Nisan) için öğrencileri de ekle
-- (Bunlar zaten Public için eklenmiş, öğrenciler de tatil yapacak)
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (602, 2, 5); -- Good Friday
INSERT INTO junction (holiday_id, region_id, person_type_id) VALUES (603, 2, 5); -- Easter Monday

COMMIT;
-- İngiltere için 2025 tatil takvimini kontrol et
-- İngiltere tatillerini basit kontrol
-- İngiltere için 2025 tatil takvimini kontrol et (Oracle SQL)
-- İngiltere tatillerini basit kontrol
-- İngiltere için 2025 tatil takvimini kontrol et (Düzeltilmiş)
SELECT 
    TO_CHAR(h.calendar_date, 'DD-MM-YYYY') || ' ' || TO_CHAR(h.calendar_date, 'Day') AS tarih,
    hd.name AS holiday_name,
    ht.name AS holiday_type,
    h.notes AS notes
FROM 
    holidays h,
    holiday_periods hp,
    holiday_definitions hd,
    holiday_types ht,
    junction j,
    region r
WHERE 
    h.period_id = hp.id
    AND hp.definition_id = hd.id
    AND hd.type_id = ht.id
    AND h.id = j.holiday_id
    AND j.region_id = r.id
    AND r.countrycode = 'ENG'
    AND j.person_type_id = 1  -- Public
    AND EXTRACT(YEAR FROM h.calendar_date) = 2025
ORDER BY 
    h.calendar_date ASC;


---ingilteredeki öğrencilerin tüm tatilleri
-- İngiltere öğrencilerinin tüm tatillerini göster (Public + Student tatilleri)
-- İngiltere öğrencilerinin tüm tatillerini göster (Public + Student tatilleri)
-- İngiltere öğrencilerinin tüm tatillerini göster (Public + Student tatilleri)
SELECT DISTINCT
    h.calendar_date,
    TO_CHAR(h.calendar_date, 'DD-MM-YYYY') AS tarih,
    TO_CHAR(h.calendar_date, 'Day') AS gun,
    hd.name AS tatil_adi,
    ht.name AS tatil_turu,
    h.notes AS notlar,
    CASE 
        WHEN j.person_type_id = 1 THEN 'Herkes için tatil'
        WHEN j.person_type_id = 3 THEN 'Sadece öğrenciler için'
    END AS tatil_kapsami
FROM 
    holidays h,
    holiday_periods hp,
    holiday_definitions hd,
    holiday_types ht,
    junction j,
    persontypes pt
WHERE 
    h.period_id = hp.id
    AND hp.definition_id = hd.id
    AND hd.type_id = ht.id
    AND h.id = j.holiday_id
    AND j.person_type_id = pt.id
    AND j.region_id = 2  -- England
    AND j.person_type_id IN (1, 3)  -- Public veya UK Students
    AND EXTRACT(YEAR FROM h.calendar_date) = 2025
ORDER BY 
    h.calendar_date;



Insert INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui_keys', 1, 'ENG', 'Settings');
Insert INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui_keys', 2, 'ENG', 'Workday Calculation');
Insert INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui_keys', 3, 'ENG', 'Holiday Summary');
Insert INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui_keys', 4, 'ENG', 'Combined Holiday Days');
insert INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui_keys', 5, 'ENG', 'Personal Event');
commit;

  INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 10, 'ENG', 'Welcome to the Calendar App 🗓️');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 11, 'ENG', 'General Settings');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 12, 'ENG', 'Please select your information before starting:');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 13, 'ENG', 'Region');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 14, 'ENG', 'Person');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 15, 'ENG', 'Language');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 16, 'ENG', 'Turkish');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 17, 'ENG', 'English');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 18, 'ENG', 'Arabic');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 19, 'ENG', 'German');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 20, 'ENG', 'Workday Calculation');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 21, 'ENG', 'Start Date:');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 22, 'ENG', 'End Date:');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 23, 'ENG', 'Calculate');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 24, 'ENG', 'Download CSV');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 25, 'ENG', 'Calculating...');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 26, 'ENG', 'Total workdays in selected range:');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 27, 'ENG', 'days');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 30, 'ENG', 'All Holidays');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 31, 'ENG', 'Get Holiday Summary');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 32, 'ENG', 'Loading holiday summary...');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 33, 'ENG', 'No holiday summary found for these criteria.');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 34, 'ENG', 'Duration:');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 35, 'ENG', 'days');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 36, 'ENG', 'Type:');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 37, 'ENG', 'Note:');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 38, 'ENG', 'Date:');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 39, 'ENG', 'Fixed Holidays (By Year)');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 40, 'ENG', 'Year:');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 41, 'ENG', 'Enter Year');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 42, 'ENG', 'Get Fixed Holidays');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 50, 'ENG', 'Find Combined Holiday Days');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 51, 'ENG', 'Year:');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 52, 'ENG', 'Find Opportunities');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 53, 'ENG', 'Searching for long weekends...');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 54, 'ENG', 'No long weekend opportunities found for these criteria.');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 55, 'ENG', 'Day Opportunity');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 56, 'ENG', 'Reasons for Long Weekends');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 99, 'ENG', 'Weekend Reason');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 60, 'ENG', 'Personal Event');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 61, 'ENG', 'Event Name:');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 62, 'ENG', 'Event Date:');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 63, 'ENG', 'Save');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 64, 'ENG', 'Fixed Holidays');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 65, 'ENG', '🗓️ Welcome to Calendar Application');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 66, 'ENG', 'Please Select which part you want to see from above menu.');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 67, 'ENG', 'Firstly make the choices of Region and Person.');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 68, 'ENG', '💬 Helper Chat');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 69, 'ENG', 'Send');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 70, 'ENG', 'Date Range');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 71, 'ENG', 'Total Days');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('ui', 72, 'ENG', 'Name of the Holiday');
commit;

INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('persontypes', 1, 'ENG', 'All');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('persontypes', 2, 'ENG', 'White Collar');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('persontypes', 3, 'ENG', 'Student');

INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidays', 10, 'ENG', 'Ramadan Holiday');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidays', 30, 'ENG', 'New Year');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidays', 40, 'ENG', 'National Sovereignty and Children s Day
');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidays', 50, 'ENG', 'Labor Day');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidays', 60, 'ENG', 'Commemoration of Atatürk, Youth and Sports Day');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidays', 20, 'ENG', 'Eid al-Adha');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidays', 70, 'ENG', 'Democracy and National Unity Day');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidays', 80, 'ENG', 'Victoy Day');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidays', 90, 'ENG', 'Republic Day');

INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holiday_type', 1, 'ENG', 'National Holiday');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holiday_type', 2, 'ENG', 'Religional Holiday');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holiday_type', 3, 'ENG', 'Administrative Leave');
commit;

--notların çevirilerini ekliyorum, holidaynotes olarak isimlendirdim
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidaynotes', 501, 'ENG', 'Ramadan Eve - Half Day Holiday');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidaynotes', 502, 'ENG', 'First Day');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidaynotes', 503, 'ENG', 'Second Day');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidaynotes', 504, 'ENG', 'Third Day');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidaynotes', 512, 'ENG', 'Labor and Solidarity Day');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidaynotes', 505, 'ENG', 'Eid al Adha Eve - Half Day Holiday');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidaynotes', 506, 'ENG', 'First Day');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidaynotes', 507, 'ENG', 'Second Day');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidaynotes', 508, 'ENG', 'Third Day');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidaynotes', 509, 'ENG', 'Fourth Day');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidaynotes', 514, 'ENG', '15 July');
INSERT INTO translations (table_name, record_id, lang_code, translation_text) VALUES ('holidaynotes', 516, 'ENG', 'Republic Day Eve');


SELECT calendar_date, is_full_day
FROM holidays h
JOIN junction j ON h.id = j.holiday_id
WHERE calendar_date BETWEEN TO_DATE('2025-04-07', 'YYYY-MM-DD')
                        AND TO_DATE('2025-04-22', 'YYYY-MM-DD')
  AND j.region_id = 2
  AND j.person_type_id IN (1);

  SELECT calendar_date, is_full_day
FROM holidays h
JOIN junction j ON h.id = j.holiday_id
WHERE calendar_date = TO_DATE('21/04/2025', 'DD/MM/YYYY')
  AND j.region_id = 2
  AND j.person_type_id IN (1);
